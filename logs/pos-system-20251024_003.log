2025-10-24 20:30:05.173 +03:00 [INF] [] Starting POS System API... {"MachineName":"DESKTOP-CMP5LCV","EnvironmentName":"Development"}
2025-10-24 20:30:05.991 +03:00 [WRN] [Microsoft.EntityFrameworkCore.Model.Validation] The property 'ShopInventory.Batches' is a collection or enumeration type with a value converter but with no value comparer. Set a value comparer to ensure the collection/enumeration elements are compared correctly. {"EventId":{"Id":10620,"Name":"Microsoft.EntityFrameworkCore.Model.Validation.CollectionWithoutComparer"},"MachineName":"DESKTOP-CMP5LCV","EnvironmentName":"Development"}
2025-10-24 20:30:05.995 +03:00 [WRN] [Microsoft.EntityFrameworkCore.Model.Validation] The property 'ShopUser.Permissions' is a collection or enumeration type with a value converter but with no value comparer. Set a value comparer to ensure the collection/enumeration elements are compared correctly. {"EventId":{"Id":10620,"Name":"Microsoft.EntityFrameworkCore.Model.Validation.CollectionWithoutComparer"},"MachineName":"DESKTOP-CMP5LCV","EnvironmentName":"Development"}
2025-10-24 20:30:06.032 +03:00 [WRN] [Microsoft.EntityFrameworkCore.Model.Validation] The 'bool' property 'IsActive' on entity type 'User' is configured with a database-generated default. This default will always be used for inserts when the property has the value 'false', since this is the CLR default for the 'bool' type. Consider using the nullable 'bool?' type instead, so that the default will only be used for inserts when the property value is 'null'. {"EventId":{"Id":20601,"Name":"Microsoft.EntityFrameworkCore.Model.Validation.BoolWithDefaultWarning"},"MachineName":"DESKTOP-CMP5LCV","EnvironmentName":"Development"}
2025-10-24 20:30:06.034 +03:00 [WRN] [Microsoft.EntityFrameworkCore.Model.Validation] The 'bool' property 'IsActive' on entity type 'ShopUser' is configured with a database-generated default. This default will always be used for inserts when the property has the value 'false', since this is the CLR default for the 'bool' type. Consider using the nullable 'bool?' type instead, so that the default will only be used for inserts when the property value is 'null'. {"EventId":{"Id":20601,"Name":"Microsoft.EntityFrameworkCore.Model.Validation.BoolWithDefaultWarning"},"MachineName":"DESKTOP-CMP5LCV","EnvironmentName":"Development"}
2025-10-24 20:30:07.507 +03:00 [INF] [] POS System API started successfully {"MachineName":"DESKTOP-CMP5LCV","EnvironmentName":"Development"}
2025-10-24 20:30:07.550 +03:00 [FTL] [] Application terminated unexpectedly {"MachineName":"DESKTOP-CMP5LCV","EnvironmentName":"Development"}
System.IO.IOException: Failed to bind to address http://127.0.0.1:5135: address already in use.
 ---> Microsoft.AspNetCore.Connections.AddressInUseException: Only one usage of each socket address (protocol/network address/port) is normally permitted.
 ---> System.Net.Sockets.SocketException (10048): Only one usage of each socket address (protocol/network address/port) is normally permitted.
   at System.Net.Sockets.Socket.UpdateStatusAfterSocketErrorAndThrowException(SocketError error, String callerName)
   at System.Net.Sockets.Socket.DoBind(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Bind(EndPoint localEP)
   at Microsoft.AspNetCore.Server.Kestrel.Transport.Sockets.SocketTransportOptions.CreateDefaultBoundListenSocket(EndPoint endpoint)
   at Microsoft.AspNetCore.Server.Kestrel.Transport.Sockets.SocketConnectionListener.Bind()
   --- End of inner exception stack trace ---
   at Microsoft.AspNetCore.Server.Kestrel.Transport.Sockets.SocketConnectionListener.Bind()
   at Microsoft.AspNetCore.Server.Kestrel.Transport.Sockets.SocketTransportFactory.BindAsync(EndPoint endpoint, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Infrastructure.TransportManager.BindAsync(EndPoint endPoint, ConnectionDelegate connectionDelegate, EndpointConfig endpointConfig, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Core.KestrelServerImpl.<>c__DisplayClass30_0`1.<<StartAsync>g__OnBind|0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.AddressBinder.BindEndpointAsync(ListenOptions endpoint, AddressBindContext context, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.AddressBinder.BindEndpointAsync(ListenOptions endpoint, AddressBindContext context, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Core.LocalhostListenOptions.BindAsync(AddressBindContext context, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.AddressBinder.AddressesStrategy.BindAsync(AddressBindContext context, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.AddressBinder.BindAsync(IEnumerable`1 listenOptions, AddressBindContext context, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Core.KestrelServerImpl.BindAsync(CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Core.KestrelServerImpl.StartAsync[TContext](IHttpApplication`1 application, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Hosting.GenericWebHostService.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.Internal.Host.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.RunAsync(IHost host, CancellationToken token)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.RunAsync(IHost host, CancellationToken token)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.Run(IHost host)
   at Microsoft.AspNetCore.Builder.WebApplication.Run(String url)
   at Program.<Main>$(String[] args) in C:\Users\pc\Documents\My Projects\pos_system_api\Program.cs:line 117
2025-10-24 20:30:07.573 +03:00 [INF] [] Shutting down POS System API... {"MachineName":"DESKTOP-CMP5LCV","EnvironmentName":"Development"}
2025-10-24 20:30:42.972 +03:00 [INF] [] Starting POS System API... {"MachineName":"DESKTOP-CMP5LCV","EnvironmentName":"Development"}
2025-10-24 20:30:43.805 +03:00 [WRN] [Microsoft.EntityFrameworkCore.Model.Validation] The property 'ShopInventory.Batches' is a collection or enumeration type with a value converter but with no value comparer. Set a value comparer to ensure the collection/enumeration elements are compared correctly. {"EventId":{"Id":10620,"Name":"Microsoft.EntityFrameworkCore.Model.Validation.CollectionWithoutComparer"},"MachineName":"DESKTOP-CMP5LCV","EnvironmentName":"Development"}
2025-10-24 20:30:43.808 +03:00 [WRN] [Microsoft.EntityFrameworkCore.Model.Validation] The property 'ShopUser.Permissions' is a collection or enumeration type with a value converter but with no value comparer. Set a value comparer to ensure the collection/enumeration elements are compared correctly. {"EventId":{"Id":10620,"Name":"Microsoft.EntityFrameworkCore.Model.Validation.CollectionWithoutComparer"},"MachineName":"DESKTOP-CMP5LCV","EnvironmentName":"Development"}
2025-10-24 20:30:43.845 +03:00 [WRN] [Microsoft.EntityFrameworkCore.Model.Validation] The 'bool' property 'IsActive' on entity type 'User' is configured with a database-generated default. This default will always be used for inserts when the property has the value 'false', since this is the CLR default for the 'bool' type. Consider using the nullable 'bool?' type instead, so that the default will only be used for inserts when the property value is 'null'. {"EventId":{"Id":20601,"Name":"Microsoft.EntityFrameworkCore.Model.Validation.BoolWithDefaultWarning"},"MachineName":"DESKTOP-CMP5LCV","EnvironmentName":"Development"}
2025-10-24 20:30:43.848 +03:00 [WRN] [Microsoft.EntityFrameworkCore.Model.Validation] The 'bool' property 'IsActive' on entity type 'ShopUser' is configured with a database-generated default. This default will always be used for inserts when the property has the value 'false', since this is the CLR default for the 'bool' type. Consider using the nullable 'bool?' type instead, so that the default will only be used for inserts when the property value is 'null'. {"EventId":{"Id":20601,"Name":"Microsoft.EntityFrameworkCore.Model.Validation.BoolWithDefaultWarning"},"MachineName":"DESKTOP-CMP5LCV","EnvironmentName":"Development"}
2025-10-24 20:30:45.237 +03:00 [INF] [] POS System API started successfully {"MachineName":"DESKTOP-CMP5LCV","EnvironmentName":"Development"}
2025-10-24 20:30:46.856 +03:00 [INF] [pos_system_api.API.Middleware.RequestResponseLoggingMiddleware] HTTP POST /api/inventory/shops/SHOP-764C0CB3/stock started {"RequestId":"0HNGJ4C8KK3VJ:00000002","ConnectionId":"0HNGJ4C8KK3VJ","RemoteIpAddress":"::1","UserAgent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","MachineName":"DESKTOP-CMP5LCV","EnvironmentName":"Development"}
2025-10-24 20:30:47.409 +03:00 [ERR] [Microsoft.EntityFrameworkCore.Database.Command] Failed executing DbCommand (110ms) [Parameters=[@p0='?', @p1='?' (DbType = Object), @p2='?' (DbType = DateTime), @p3='?', @p4='?', @p5='?' (DbType = Boolean), @p6='?' (DbType = DateTime), @p7='?' (DbType = DateTime), @p8='?' (DbType = Int32), @p9='?', @p10='?', @p11='?' (DbType = Int32), @p12='?', @p13='?' (DbType = Decimal), @p14='?', @p15='?' (DbType = Decimal), @p16='?' (DbType = DateTime), @p17='?' (DbType = Decimal), @p18='?' (DbType = Decimal)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "ShopInventory" ("Id", "Batches", "CreatedAt", "CreatedBy", "DrugId", "IsAvailable", "LastRestockDate", "LastUpdated", "ReorderPoint", "ShopId", "StorageLocation", "TotalStock", "UpdatedBy", "Pricing_CostPrice", "Pricing_Currency", "Pricing_Discount", "Pricing_LastPriceUpdate", "Pricing_SellingPrice", "Pricing_TaxRate")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18); {"EventId":{"Id":20102,"Name":"Microsoft.EntityFrameworkCore.Database.Command.CommandError"},"ActionId":"30322052-7ed8-49d8-b0c8-953884030eba","ActionName":"pos_system_api.API.Controllers.InventoryController.AddStock (pos_system_api)","RequestId":"0HNGJ4C8KK3VJ:00000002","RequestPath":"/api/inventory/shops/SHOP-764C0CB3/stock","ConnectionId":"0HNGJ4C8KK3VJ","RemoteIpAddress":"::1","UserAgent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","RequestQuery":"","RequestMethod":"POST","MachineName":"DESKTOP-CMP5LCV","EnvironmentName":"Development"}
2025-10-24 20:30:47.511 +03:00 [ERR] [Microsoft.EntityFrameworkCore.Update] An exception occurred in the database while saving changes for context type 'pos_system_api.Infrastructure.Data.ApplicationDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Npgsql.PostgresException (0x80004005): 23503: insert or update on table "ShopInventory" violates foreign key constraint "FK_ShopInventory_Drugs_DrugId"

DETAIL: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
   at Npgsql.Internal.NpgsqlConnector.<ReadMessage>g__ReadMessageLong|223_0(NpgsqlConnector connector, Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
  Exception data:
    Severity: ERROR
    SqlState: 23503
    MessageText: insert or update on table "ShopInventory" violates foreign key constraint "FK_ShopInventory_Drugs_DrugId"
    Detail: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
    SchemaName: public
    TableName: ShopInventory
    ConstraintName: FK_ShopInventory_Drugs_DrugId
    File: ri_triggers.c
    Line: 2599
    Routine: ri_ReportViolation
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken) {"EventId":{"Id":10000,"Name":"Microsoft.EntityFrameworkCore.Update.SaveChangesFailed"},"ActionId":"30322052-7ed8-49d8-b0c8-953884030eba","ActionName":"pos_system_api.API.Controllers.InventoryController.AddStock (pos_system_api)","RequestId":"0HNGJ4C8KK3VJ:00000002","RequestPath":"/api/inventory/shops/SHOP-764C0CB3/stock","ConnectionId":"0HNGJ4C8KK3VJ","RemoteIpAddress":"::1","UserAgent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","RequestQuery":"","RequestMethod":"POST","MachineName":"DESKTOP-CMP5LCV","EnvironmentName":"Development"}
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Npgsql.PostgresException (0x80004005): 23503: insert or update on table "ShopInventory" violates foreign key constraint "FK_ShopInventory_Drugs_DrugId"

DETAIL: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
   at Npgsql.Internal.NpgsqlConnector.<ReadMessage>g__ReadMessageLong|223_0(NpgsqlConnector connector, Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
  Exception data:
    Severity: ERROR
    SqlState: 23503
    MessageText: insert or update on table "ShopInventory" violates foreign key constraint "FK_ShopInventory_Drugs_DrugId"
    Detail: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
    SchemaName: public
    TableName: ShopInventory
    ConstraintName: FK_ShopInventory_Drugs_DrugId
    File: ri_triggers.c
    Line: 2599
    Routine: ri_ReportViolation
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-10-24 20:30:47.561 +03:00 [INF] [Serilog.AspNetCore.RequestLoggingMiddleware] HTTP POST /api/inventory/shops/SHOP-764C0CB3/stock responded 400 in 698.5782ms {"RequestHost":"localhost:5135","RequestScheme":"http","UserAgent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","RemoteIpAddress":"::1","RequestQuery":"","RequestId":"0HNGJ4C8KK3VJ:00000002","ConnectionId":"0HNGJ4C8KK3VJ","MachineName":"DESKTOP-CMP5LCV","EnvironmentName":"Development"}
2025-10-24 20:30:47.565 +03:00 [WRN] [pos_system_api.API.Middleware.RequestResponseLoggingMiddleware] HTTP POST /api/inventory/shops/SHOP-764C0CB3/stock responded 400 in 713ms {"RequestId":"0HNGJ4C8KK3VJ:00000002","ConnectionId":"0HNGJ4C8KK3VJ","RemoteIpAddress":"::1","UserAgent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","MachineName":"DESKTOP-CMP5LCV","EnvironmentName":"Development"}
2025-10-24 20:30:51.398 +03:00 [INF] [pos_system_api.API.Middleware.RequestResponseLoggingMiddleware] HTTP POST /api/inventory/shops/SHOP-764C0CB3/stock started {"RequestId":"0HNGJ4C8KK3VJ:00000003","ConnectionId":"0HNGJ4C8KK3VJ","RemoteIpAddress":"::1","UserAgent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","MachineName":"DESKTOP-CMP5LCV","EnvironmentName":"Development"}
2025-10-24 20:30:51.604 +03:00 [ERR] [Microsoft.EntityFrameworkCore.Database.Command] Failed executing DbCommand (74ms) [Parameters=[@p0='?', @p1='?' (DbType = Object), @p2='?' (DbType = DateTime), @p3='?', @p4='?', @p5='?' (DbType = Boolean), @p6='?' (DbType = DateTime), @p7='?' (DbType = DateTime), @p8='?' (DbType = Int32), @p9='?', @p10='?', @p11='?' (DbType = Int32), @p12='?', @p13='?' (DbType = Decimal), @p14='?', @p15='?' (DbType = Decimal), @p16='?' (DbType = DateTime), @p17='?' (DbType = Decimal), @p18='?' (DbType = Decimal)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "ShopInventory" ("Id", "Batches", "CreatedAt", "CreatedBy", "DrugId", "IsAvailable", "LastRestockDate", "LastUpdated", "ReorderPoint", "ShopId", "StorageLocation", "TotalStock", "UpdatedBy", "Pricing_CostPrice", "Pricing_Currency", "Pricing_Discount", "Pricing_LastPriceUpdate", "Pricing_SellingPrice", "Pricing_TaxRate")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18); {"EventId":{"Id":20102,"Name":"Microsoft.EntityFrameworkCore.Database.Command.CommandError"},"ActionId":"30322052-7ed8-49d8-b0c8-953884030eba","ActionName":"pos_system_api.API.Controllers.InventoryController.AddStock (pos_system_api)","RequestId":"0HNGJ4C8KK3VJ:00000003","RequestPath":"/api/inventory/shops/SHOP-764C0CB3/stock","ConnectionId":"0HNGJ4C8KK3VJ","RemoteIpAddress":"::1","UserAgent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","RequestQuery":"","RequestMethod":"POST","MachineName":"DESKTOP-CMP5LCV","EnvironmentName":"Development"}
2025-10-24 20:30:51.682 +03:00 [ERR] [Microsoft.EntityFrameworkCore.Update] An exception occurred in the database while saving changes for context type 'pos_system_api.Infrastructure.Data.ApplicationDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Npgsql.PostgresException (0x80004005): 23503: insert or update on table "ShopInventory" violates foreign key constraint "FK_ShopInventory_Drugs_DrugId"

DETAIL: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
   at Npgsql.Internal.NpgsqlConnector.<ReadMessage>g__ReadMessageLong|223_0(NpgsqlConnector connector, Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
  Exception data:
    Severity: ERROR
    SqlState: 23503
    MessageText: insert or update on table "ShopInventory" violates foreign key constraint "FK_ShopInventory_Drugs_DrugId"
    Detail: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
    SchemaName: public
    TableName: ShopInventory
    ConstraintName: FK_ShopInventory_Drugs_DrugId
    File: ri_triggers.c
    Line: 2599
    Routine: ri_ReportViolation
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken) {"EventId":{"Id":10000,"Name":"Microsoft.EntityFrameworkCore.Update.SaveChangesFailed"},"ActionId":"30322052-7ed8-49d8-b0c8-953884030eba","ActionName":"pos_system_api.API.Controllers.InventoryController.AddStock (pos_system_api)","RequestId":"0HNGJ4C8KK3VJ:00000003","RequestPath":"/api/inventory/shops/SHOP-764C0CB3/stock","ConnectionId":"0HNGJ4C8KK3VJ","RemoteIpAddress":"::1","UserAgent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","RequestQuery":"","RequestMethod":"POST","MachineName":"DESKTOP-CMP5LCV","EnvironmentName":"Development"}
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Npgsql.PostgresException (0x80004005): 23503: insert or update on table "ShopInventory" violates foreign key constraint "FK_ShopInventory_Drugs_DrugId"

DETAIL: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
   at Npgsql.Internal.NpgsqlConnector.<ReadMessage>g__ReadMessageLong|223_0(NpgsqlConnector connector, Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
  Exception data:
    Severity: ERROR
    SqlState: 23503
    MessageText: insert or update on table "ShopInventory" violates foreign key constraint "FK_ShopInventory_Drugs_DrugId"
    Detail: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
    SchemaName: public
    TableName: ShopInventory
    ConstraintName: FK_ShopInventory_Drugs_DrugId
    File: ri_triggers.c
    Line: 2599
    Routine: ri_ReportViolation
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-10-24 20:30:51.691 +03:00 [INF] [Serilog.AspNetCore.RequestLoggingMiddleware] HTTP POST /api/inventory/shops/SHOP-764C0CB3/stock responded 400 in 289.8181ms {"RequestHost":"localhost:5135","RequestScheme":"http","UserAgent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","RemoteIpAddress":"::1","RequestQuery":"","RequestId":"0HNGJ4C8KK3VJ:00000003","ConnectionId":"0HNGJ4C8KK3VJ","MachineName":"DESKTOP-CMP5LCV","EnvironmentName":"Development"}
2025-10-24 20:30:51.694 +03:00 [WRN] [pos_system_api.API.Middleware.RequestResponseLoggingMiddleware] HTTP POST /api/inventory/shops/SHOP-764C0CB3/stock responded 400 in 296ms {"RequestId":"0HNGJ4C8KK3VJ:00000003","ConnectionId":"0HNGJ4C8KK3VJ","RemoteIpAddress":"::1","UserAgent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","MachineName":"DESKTOP-CMP5LCV","EnvironmentName":"Development"}
2025-10-24 20:31:25.117 +03:00 [INF] [pos_system_api.API.Middleware.RequestResponseLoggingMiddleware] HTTP POST /api/inventory/shops/SHOP-764C0CB3/stock started {"RequestId":"0HNGJ4C8KK3VJ:00000004","ConnectionId":"0HNGJ4C8KK3VJ","RemoteIpAddress":"::1","UserAgent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","MachineName":"DESKTOP-CMP5LCV","EnvironmentName":"Development"}
2025-10-24 20:31:25.275 +03:00 [ERR] [Microsoft.EntityFrameworkCore.Database.Command] Failed executing DbCommand (72ms) [Parameters=[@p0='?', @p1='?' (DbType = Object), @p2='?' (DbType = DateTime), @p3='?', @p4='?', @p5='?' (DbType = Boolean), @p6='?' (DbType = DateTime), @p7='?' (DbType = DateTime), @p8='?' (DbType = Int32), @p9='?', @p10='?', @p11='?' (DbType = Int32), @p12='?', @p13='?' (DbType = Decimal), @p14='?', @p15='?' (DbType = Decimal), @p16='?' (DbType = DateTime), @p17='?' (DbType = Decimal), @p18='?' (DbType = Decimal)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "ShopInventory" ("Id", "Batches", "CreatedAt", "CreatedBy", "DrugId", "IsAvailable", "LastRestockDate", "LastUpdated", "ReorderPoint", "ShopId", "StorageLocation", "TotalStock", "UpdatedBy", "Pricing_CostPrice", "Pricing_Currency", "Pricing_Discount", "Pricing_LastPriceUpdate", "Pricing_SellingPrice", "Pricing_TaxRate")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18); {"EventId":{"Id":20102,"Name":"Microsoft.EntityFrameworkCore.Database.Command.CommandError"},"ActionId":"30322052-7ed8-49d8-b0c8-953884030eba","ActionName":"pos_system_api.API.Controllers.InventoryController.AddStock (pos_system_api)","RequestId":"0HNGJ4C8KK3VJ:00000004","RequestPath":"/api/inventory/shops/SHOP-764C0CB3/stock","ConnectionId":"0HNGJ4C8KK3VJ","RemoteIpAddress":"::1","UserAgent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","RequestQuery":"","RequestMethod":"POST","MachineName":"DESKTOP-CMP5LCV","EnvironmentName":"Development"}
2025-10-24 20:31:25.356 +03:00 [ERR] [Microsoft.EntityFrameworkCore.Update] An exception occurred in the database while saving changes for context type 'pos_system_api.Infrastructure.Data.ApplicationDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Npgsql.PostgresException (0x80004005): 23503: insert or update on table "ShopInventory" violates foreign key constraint "FK_ShopInventory_Drugs_DrugId"

DETAIL: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
   at Npgsql.Internal.NpgsqlConnector.<ReadMessage>g__ReadMessageLong|223_0(NpgsqlConnector connector, Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
  Exception data:
    Severity: ERROR
    SqlState: 23503
    MessageText: insert or update on table "ShopInventory" violates foreign key constraint "FK_ShopInventory_Drugs_DrugId"
    Detail: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
    SchemaName: public
    TableName: ShopInventory
    ConstraintName: FK_ShopInventory_Drugs_DrugId
    File: ri_triggers.c
    Line: 2599
    Routine: ri_ReportViolation
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken) {"EventId":{"Id":10000,"Name":"Microsoft.EntityFrameworkCore.Update.SaveChangesFailed"},"ActionId":"30322052-7ed8-49d8-b0c8-953884030eba","ActionName":"pos_system_api.API.Controllers.InventoryController.AddStock (pos_system_api)","RequestId":"0HNGJ4C8KK3VJ:00000004","RequestPath":"/api/inventory/shops/SHOP-764C0CB3/stock","ConnectionId":"0HNGJ4C8KK3VJ","RemoteIpAddress":"::1","UserAgent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","RequestQuery":"","RequestMethod":"POST","MachineName":"DESKTOP-CMP5LCV","EnvironmentName":"Development"}
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Npgsql.PostgresException (0x80004005): 23503: insert or update on table "ShopInventory" violates foreign key constraint "FK_ShopInventory_Drugs_DrugId"

DETAIL: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
   at Npgsql.Internal.NpgsqlConnector.<ReadMessage>g__ReadMessageLong|223_0(NpgsqlConnector connector, Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
  Exception data:
    Severity: ERROR
    SqlState: 23503
    MessageText: insert or update on table "ShopInventory" violates foreign key constraint "FK_ShopInventory_Drugs_DrugId"
    Detail: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
    SchemaName: public
    TableName: ShopInventory
    ConstraintName: FK_ShopInventory_Drugs_DrugId
    File: ri_triggers.c
    Line: 2599
    Routine: ri_ReportViolation
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-10-24 20:31:25.367 +03:00 [INF] [Serilog.AspNetCore.RequestLoggingMiddleware] HTTP POST /api/inventory/shops/SHOP-764C0CB3/stock responded 400 in 246.6391ms {"RequestHost":"localhost:5135","RequestScheme":"http","UserAgent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","RemoteIpAddress":"::1","RequestQuery":"","RequestId":"0HNGJ4C8KK3VJ:00000004","ConnectionId":"0HNGJ4C8KK3VJ","MachineName":"DESKTOP-CMP5LCV","EnvironmentName":"Development"}
2025-10-24 20:31:25.372 +03:00 [WRN] [pos_system_api.API.Middleware.RequestResponseLoggingMiddleware] HTTP POST /api/inventory/shops/SHOP-764C0CB3/stock responded 400 in 254ms {"RequestId":"0HNGJ4C8KK3VJ:00000004","ConnectionId":"0HNGJ4C8KK3VJ","RemoteIpAddress":"::1","UserAgent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","MachineName":"DESKTOP-CMP5LCV","EnvironmentName":"Development"}
2025-10-24 20:31:29.073 +03:00 [INF] [pos_system_api.API.Middleware.RequestResponseLoggingMiddleware] HTTP POST /api/inventory/shops/SHOP-764C0CB3/stock started {"RequestId":"0HNGJ4C8KK3VJ:00000005","ConnectionId":"0HNGJ4C8KK3VJ","RemoteIpAddress":"::1","UserAgent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","MachineName":"DESKTOP-CMP5LCV","EnvironmentName":"Development"}
2025-10-24 20:31:29.225 +03:00 [ERR] [Microsoft.EntityFrameworkCore.Database.Command] Failed executing DbCommand (73ms) [Parameters=[@p0='?', @p1='?' (DbType = Object), @p2='?' (DbType = DateTime), @p3='?', @p4='?', @p5='?' (DbType = Boolean), @p6='?' (DbType = DateTime), @p7='?' (DbType = DateTime), @p8='?' (DbType = Int32), @p9='?', @p10='?', @p11='?' (DbType = Int32), @p12='?', @p13='?' (DbType = Decimal), @p14='?', @p15='?' (DbType = Decimal), @p16='?' (DbType = DateTime), @p17='?' (DbType = Decimal), @p18='?' (DbType = Decimal)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "ShopInventory" ("Id", "Batches", "CreatedAt", "CreatedBy", "DrugId", "IsAvailable", "LastRestockDate", "LastUpdated", "ReorderPoint", "ShopId", "StorageLocation", "TotalStock", "UpdatedBy", "Pricing_CostPrice", "Pricing_Currency", "Pricing_Discount", "Pricing_LastPriceUpdate", "Pricing_SellingPrice", "Pricing_TaxRate")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18); {"EventId":{"Id":20102,"Name":"Microsoft.EntityFrameworkCore.Database.Command.CommandError"},"ActionId":"30322052-7ed8-49d8-b0c8-953884030eba","ActionName":"pos_system_api.API.Controllers.InventoryController.AddStock (pos_system_api)","RequestId":"0HNGJ4C8KK3VJ:00000005","RequestPath":"/api/inventory/shops/SHOP-764C0CB3/stock","ConnectionId":"0HNGJ4C8KK3VJ","RemoteIpAddress":"::1","UserAgent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","RequestQuery":"","RequestMethod":"POST","MachineName":"DESKTOP-CMP5LCV","EnvironmentName":"Development"}
2025-10-24 20:31:29.306 +03:00 [ERR] [Microsoft.EntityFrameworkCore.Update] An exception occurred in the database while saving changes for context type 'pos_system_api.Infrastructure.Data.ApplicationDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Npgsql.PostgresException (0x80004005): 23503: insert or update on table "ShopInventory" violates foreign key constraint "FK_ShopInventory_Drugs_DrugId"

DETAIL: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
   at Npgsql.Internal.NpgsqlConnector.<ReadMessage>g__ReadMessageLong|223_0(NpgsqlConnector connector, Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
  Exception data:
    Severity: ERROR
    SqlState: 23503
    MessageText: insert or update on table "ShopInventory" violates foreign key constraint "FK_ShopInventory_Drugs_DrugId"
    Detail: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
    SchemaName: public
    TableName: ShopInventory
    ConstraintName: FK_ShopInventory_Drugs_DrugId
    File: ri_triggers.c
    Line: 2599
    Routine: ri_ReportViolation
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken) {"EventId":{"Id":10000,"Name":"Microsoft.EntityFrameworkCore.Update.SaveChangesFailed"},"ActionId":"30322052-7ed8-49d8-b0c8-953884030eba","ActionName":"pos_system_api.API.Controllers.InventoryController.AddStock (pos_system_api)","RequestId":"0HNGJ4C8KK3VJ:00000005","RequestPath":"/api/inventory/shops/SHOP-764C0CB3/stock","ConnectionId":"0HNGJ4C8KK3VJ","RemoteIpAddress":"::1","UserAgent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","RequestQuery":"","RequestMethod":"POST","MachineName":"DESKTOP-CMP5LCV","EnvironmentName":"Development"}
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Npgsql.PostgresException (0x80004005): 23503: insert or update on table "ShopInventory" violates foreign key constraint "FK_ShopInventory_Drugs_DrugId"

DETAIL: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
   at Npgsql.Internal.NpgsqlConnector.<ReadMessage>g__ReadMessageLong|223_0(NpgsqlConnector connector, Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
  Exception data:
    Severity: ERROR
    SqlState: 23503
    MessageText: insert or update on table "ShopInventory" violates foreign key constraint "FK_ShopInventory_Drugs_DrugId"
    Detail: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
    SchemaName: public
    TableName: ShopInventory
    ConstraintName: FK_ShopInventory_Drugs_DrugId
    File: ri_triggers.c
    Line: 2599
    Routine: ri_ReportViolation
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-10-24 20:31:29.316 +03:00 [INF] [Serilog.AspNetCore.RequestLoggingMiddleware] HTTP POST /api/inventory/shops/SHOP-764C0CB3/stock responded 400 in 239.1025ms {"RequestHost":"localhost:5135","RequestScheme":"http","UserAgent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","RemoteIpAddress":"::1","RequestQuery":"","RequestId":"0HNGJ4C8KK3VJ:00000005","ConnectionId":"0HNGJ4C8KK3VJ","MachineName":"DESKTOP-CMP5LCV","EnvironmentName":"Development"}
2025-10-24 20:31:29.319 +03:00 [WRN] [pos_system_api.API.Middleware.RequestResponseLoggingMiddleware] HTTP POST /api/inventory/shops/SHOP-764C0CB3/stock responded 400 in 246ms {"RequestId":"0HNGJ4C8KK3VJ:00000005","ConnectionId":"0HNGJ4C8KK3VJ","RemoteIpAddress":"::1","UserAgent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","MachineName":"DESKTOP-CMP5LCV","EnvironmentName":"Development"}
2025-10-24 20:31:54.026 +03:00 [INF] [pos_system_api.API.Middleware.RequestResponseLoggingMiddleware] HTTP GET /api/Suppliers?page=1&limit=20&isActive=true started {"RequestId":"0HNGJ4C8KK3VJ:00000006","ConnectionId":"0HNGJ4C8KK3VJ","RemoteIpAddress":"::1","UserAgent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","MachineName":"DESKTOP-CMP5LCV","EnvironmentName":"Development"}
2025-10-24 20:31:54.040 +03:00 [INF] [Serilog.AspNetCore.RequestLoggingMiddleware] HTTP GET /api/Suppliers responded 401 in 11.6058ms {"RequestHost":"localhost:5135","RequestScheme":"http","UserAgent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","RemoteIpAddress":"::1","RequestQuery":"?page=1&limit=20&isActive=true","RequestId":"0HNGJ4C8KK3VJ:00000006","ConnectionId":"0HNGJ4C8KK3VJ","MachineName":"DESKTOP-CMP5LCV","EnvironmentName":"Development"}
2025-10-24 20:31:54.047 +03:00 [WRN] [pos_system_api.API.Middleware.RequestResponseLoggingMiddleware] HTTP GET /api/Suppliers?page=1&limit=20&isActive=true responded 401 in 20ms {"RequestId":"0HNGJ4C8KK3VJ:00000006","ConnectionId":"0HNGJ4C8KK3VJ","RemoteIpAddress":"::1","UserAgent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","MachineName":"DESKTOP-CMP5LCV","EnvironmentName":"Development"}
2025-10-24 20:32:00.343 +03:00 [INF] [pos_system_api.API.Middleware.RequestResponseLoggingMiddleware] HTTP GET /api/Suppliers?page=1&limit=20&isActive=true started {"RequestId":"0HNGJ4C8KK3VJ:00000007","ConnectionId":"0HNGJ4C8KK3VJ","RemoteIpAddress":"::1","UserAgent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","MachineName":"DESKTOP-CMP5LCV","EnvironmentName":"Development"}
2025-10-24 20:32:00.353 +03:00 [INF] [Serilog.AspNetCore.RequestLoggingMiddleware] HTTP GET /api/Suppliers responded 401 in 0.6235ms {"RequestHost":"localhost:5135","RequestScheme":"http","UserAgent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","RemoteIpAddress":"::1","RequestQuery":"?page=1&limit=20&isActive=true","RequestId":"0HNGJ4C8KK3VJ:00000007","ConnectionId":"0HNGJ4C8KK3VJ","MachineName":"DESKTOP-CMP5LCV","EnvironmentName":"Development"}
2025-10-24 20:32:00.357 +03:00 [WRN] [pos_system_api.API.Middleware.RequestResponseLoggingMiddleware] HTTP GET /api/Suppliers?page=1&limit=20&isActive=true responded 401 in 13ms {"RequestId":"0HNGJ4C8KK3VJ:00000007","ConnectionId":"0HNGJ4C8KK3VJ","RemoteIpAddress":"::1","UserAgent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","MachineName":"DESKTOP-CMP5LCV","EnvironmentName":"Development"}
2025-10-24 20:33:06.248 +03:00 [INF] [pos_system_api.API.Middleware.RequestResponseLoggingMiddleware] HTTP POST /api/inventory/shops/SHOP-764C0CB3/stock started {"RequestId":"0HNGJ4C8KK3VJ:00000008","ConnectionId":"0HNGJ4C8KK3VJ","RemoteIpAddress":"::1","UserAgent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","MachineName":"DESKTOP-CMP5LCV","EnvironmentName":"Development"}
2025-10-24 20:33:06.402 +03:00 [ERR] [Microsoft.EntityFrameworkCore.Database.Command] Failed executing DbCommand (73ms) [Parameters=[@p0='?', @p1='?' (DbType = Object), @p2='?' (DbType = DateTime), @p3='?', @p4='?', @p5='?' (DbType = Boolean), @p6='?' (DbType = DateTime), @p7='?' (DbType = DateTime), @p8='?' (DbType = Int32), @p9='?', @p10='?', @p11='?' (DbType = Int32), @p12='?', @p13='?' (DbType = Decimal), @p14='?', @p15='?' (DbType = Decimal), @p16='?' (DbType = DateTime), @p17='?' (DbType = Decimal), @p18='?' (DbType = Decimal)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "ShopInventory" ("Id", "Batches", "CreatedAt", "CreatedBy", "DrugId", "IsAvailable", "LastRestockDate", "LastUpdated", "ReorderPoint", "ShopId", "StorageLocation", "TotalStock", "UpdatedBy", "Pricing_CostPrice", "Pricing_Currency", "Pricing_Discount", "Pricing_LastPriceUpdate", "Pricing_SellingPrice", "Pricing_TaxRate")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18); {"EventId":{"Id":20102,"Name":"Microsoft.EntityFrameworkCore.Database.Command.CommandError"},"ActionId":"30322052-7ed8-49d8-b0c8-953884030eba","ActionName":"pos_system_api.API.Controllers.InventoryController.AddStock (pos_system_api)","RequestId":"0HNGJ4C8KK3VJ:00000008","RequestPath":"/api/inventory/shops/SHOP-764C0CB3/stock","ConnectionId":"0HNGJ4C8KK3VJ","RemoteIpAddress":"::1","UserAgent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","RequestQuery":"","RequestMethod":"POST","MachineName":"DESKTOP-CMP5LCV","EnvironmentName":"Development"}
2025-10-24 20:33:06.480 +03:00 [ERR] [Microsoft.EntityFrameworkCore.Update] An exception occurred in the database while saving changes for context type 'pos_system_api.Infrastructure.Data.ApplicationDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Npgsql.PostgresException (0x80004005): 23503: insert or update on table "ShopInventory" violates foreign key constraint "FK_ShopInventory_Drugs_DrugId"

DETAIL: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
   at Npgsql.Internal.NpgsqlConnector.<ReadMessage>g__ReadMessageLong|223_0(NpgsqlConnector connector, Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
  Exception data:
    Severity: ERROR
    SqlState: 23503
    MessageText: insert or update on table "ShopInventory" violates foreign key constraint "FK_ShopInventory_Drugs_DrugId"
    Detail: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
    SchemaName: public
    TableName: ShopInventory
    ConstraintName: FK_ShopInventory_Drugs_DrugId
    File: ri_triggers.c
    Line: 2599
    Routine: ri_ReportViolation
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken) {"EventId":{"Id":10000,"Name":"Microsoft.EntityFrameworkCore.Update.SaveChangesFailed"},"ActionId":"30322052-7ed8-49d8-b0c8-953884030eba","ActionName":"pos_system_api.API.Controllers.InventoryController.AddStock (pos_system_api)","RequestId":"0HNGJ4C8KK3VJ:00000008","RequestPath":"/api/inventory/shops/SHOP-764C0CB3/stock","ConnectionId":"0HNGJ4C8KK3VJ","RemoteIpAddress":"::1","UserAgent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","RequestQuery":"","RequestMethod":"POST","MachineName":"DESKTOP-CMP5LCV","EnvironmentName":"Development"}
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Npgsql.PostgresException (0x80004005): 23503: insert or update on table "ShopInventory" violates foreign key constraint "FK_ShopInventory_Drugs_DrugId"

DETAIL: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
   at Npgsql.Internal.NpgsqlConnector.<ReadMessage>g__ReadMessageLong|223_0(NpgsqlConnector connector, Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
  Exception data:
    Severity: ERROR
    SqlState: 23503
    MessageText: insert or update on table "ShopInventory" violates foreign key constraint "FK_ShopInventory_Drugs_DrugId"
    Detail: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
    SchemaName: public
    TableName: ShopInventory
    ConstraintName: FK_ShopInventory_Drugs_DrugId
    File: ri_triggers.c
    Line: 2599
    Routine: ri_ReportViolation
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-10-24 20:33:06.492 +03:00 [INF] [Serilog.AspNetCore.RequestLoggingMiddleware] HTTP POST /api/inventory/shops/SHOP-764C0CB3/stock responded 400 in 239.2637ms {"RequestHost":"localhost:5135","RequestScheme":"http","UserAgent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","RemoteIpAddress":"::1","RequestQuery":"","RequestId":"0HNGJ4C8KK3VJ:00000008","ConnectionId":"0HNGJ4C8KK3VJ","MachineName":"DESKTOP-CMP5LCV","EnvironmentName":"Development"}
2025-10-24 20:33:06.499 +03:00 [WRN] [pos_system_api.API.Middleware.RequestResponseLoggingMiddleware] HTTP POST /api/inventory/shops/SHOP-764C0CB3/stock responded 400 in 251ms {"RequestId":"0HNGJ4C8KK3VJ:00000008","ConnectionId":"0HNGJ4C8KK3VJ","RemoteIpAddress":"::1","UserAgent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","MachineName":"DESKTOP-CMP5LCV","EnvironmentName":"Development"}
2025-10-24 20:34:17.071 +03:00 [INF] [] Shutting down POS System API... {"MachineName":"DESKTOP-CMP5LCV","EnvironmentName":"Development"}
2025-10-24 20:36:54.579 +03:00 [INF] [] Starting POS System API... {"MachineName":"DESKTOP-CMP5LCV","EnvironmentName":"Development"}
2025-10-24 20:36:55.615 +03:00 [WRN] [Microsoft.EntityFrameworkCore.Model.Validation] The property 'ShopInventory.Batches' is a collection or enumeration type with a value converter but with no value comparer. Set a value comparer to ensure the collection/enumeration elements are compared correctly. {"EventId":{"Id":10620,"Name":"Microsoft.EntityFrameworkCore.Model.Validation.CollectionWithoutComparer"},"MachineName":"DESKTOP-CMP5LCV","EnvironmentName":"Development"}
2025-10-24 20:36:55.619 +03:00 [WRN] [Microsoft.EntityFrameworkCore.Model.Validation] The property 'ShopUser.Permissions' is a collection or enumeration type with a value converter but with no value comparer. Set a value comparer to ensure the collection/enumeration elements are compared correctly. {"EventId":{"Id":10620,"Name":"Microsoft.EntityFrameworkCore.Model.Validation.CollectionWithoutComparer"},"MachineName":"DESKTOP-CMP5LCV","EnvironmentName":"Development"}
2025-10-24 20:36:55.668 +03:00 [WRN] [Microsoft.EntityFrameworkCore.Model.Validation] The 'bool' property 'IsActive' on entity type 'User' is configured with a database-generated default. This default will always be used for inserts when the property has the value 'false', since this is the CLR default for the 'bool' type. Consider using the nullable 'bool?' type instead, so that the default will only be used for inserts when the property value is 'null'. {"EventId":{"Id":20601,"Name":"Microsoft.EntityFrameworkCore.Model.Validation.BoolWithDefaultWarning"},"MachineName":"DESKTOP-CMP5LCV","EnvironmentName":"Development"}
2025-10-24 20:36:55.671 +03:00 [WRN] [Microsoft.EntityFrameworkCore.Model.Validation] The 'bool' property 'IsActive' on entity type 'ShopUser' is configured with a database-generated default. This default will always be used for inserts when the property has the value 'false', since this is the CLR default for the 'bool' type. Consider using the nullable 'bool?' type instead, so that the default will only be used for inserts when the property value is 'null'. {"EventId":{"Id":20601,"Name":"Microsoft.EntityFrameworkCore.Model.Validation.BoolWithDefaultWarning"},"MachineName":"DESKTOP-CMP5LCV","EnvironmentName":"Development"}
2025-10-24 20:36:57.236 +03:00 [INF] [] POS System API started successfully {"MachineName":"DESKTOP-CMP5LCV","EnvironmentName":"Development"}
2025-10-24 20:36:57.483 +03:00 [INF] [pos_system_api.API.Middleware.RequestResponseLoggingMiddleware] HTTP POST /api/inventory/shops/SHOP-764C0CB3/stock started {"RequestId":"0HNGJ4FN37JIO:00000002","ConnectionId":"0HNGJ4FN37JIO","RemoteIpAddress":"::1","UserAgent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","MachineName":"DESKTOP-CMP5LCV","EnvironmentName":"Development"}
2025-10-24 20:36:58.229 +03:00 [ERR] [Microsoft.EntityFrameworkCore.Database.Command] Failed executing DbCommand (109ms) [Parameters=[@p0='?', @p1='?' (DbType = Object), @p2='?' (DbType = DateTime), @p3='?', @p4='?', @p5='?' (DbType = Boolean), @p6='?' (DbType = DateTime), @p7='?' (DbType = DateTime), @p8='?' (DbType = Int32), @p9='?', @p10='?', @p11='?' (DbType = Int32), @p12='?', @p13='?' (DbType = Decimal), @p14='?', @p15='?' (DbType = Decimal), @p16='?' (DbType = DateTime), @p17='?' (DbType = Decimal), @p18='?' (DbType = Decimal)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "ShopInventory" ("Id", "Batches", "CreatedAt", "CreatedBy", "DrugId", "IsAvailable", "LastRestockDate", "LastUpdated", "ReorderPoint", "ShopId", "StorageLocation", "TotalStock", "UpdatedBy", "Pricing_CostPrice", "Pricing_Currency", "Pricing_Discount", "Pricing_LastPriceUpdate", "Pricing_SellingPrice", "Pricing_TaxRate")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18); {"EventId":{"Id":20102,"Name":"Microsoft.EntityFrameworkCore.Database.Command.CommandError"},"ActionId":"28dafbba-8ef1-42bb-b730-5ca202ecaffc","ActionName":"pos_system_api.API.Controllers.InventoryController.AddStock (pos_system_api)","RequestId":"0HNGJ4FN37JIO:00000002","RequestPath":"/api/inventory/shops/SHOP-764C0CB3/stock","ConnectionId":"0HNGJ4FN37JIO","RemoteIpAddress":"::1","UserAgent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","RequestQuery":"","RequestMethod":"POST","MachineName":"DESKTOP-CMP5LCV","EnvironmentName":"Development"}
2025-10-24 20:36:58.329 +03:00 [ERR] [Microsoft.EntityFrameworkCore.Update] An exception occurred in the database while saving changes for context type 'pos_system_api.Infrastructure.Data.ApplicationDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Npgsql.PostgresException (0x80004005): 23503: insert or update on table "ShopInventory" violates foreign key constraint "FK_ShopInventory_Drugs_DrugId"

DETAIL: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
   at Npgsql.Internal.NpgsqlConnector.<ReadMessage>g__ReadMessageLong|223_0(NpgsqlConnector connector, Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
  Exception data:
    Severity: ERROR
    SqlState: 23503
    MessageText: insert or update on table "ShopInventory" violates foreign key constraint "FK_ShopInventory_Drugs_DrugId"
    Detail: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
    SchemaName: public
    TableName: ShopInventory
    ConstraintName: FK_ShopInventory_Drugs_DrugId
    File: ri_triggers.c
    Line: 2599
    Routine: ri_ReportViolation
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken) {"EventId":{"Id":10000,"Name":"Microsoft.EntityFrameworkCore.Update.SaveChangesFailed"},"ActionId":"28dafbba-8ef1-42bb-b730-5ca202ecaffc","ActionName":"pos_system_api.API.Controllers.InventoryController.AddStock (pos_system_api)","RequestId":"0HNGJ4FN37JIO:00000002","RequestPath":"/api/inventory/shops/SHOP-764C0CB3/stock","ConnectionId":"0HNGJ4FN37JIO","RemoteIpAddress":"::1","UserAgent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","RequestQuery":"","RequestMethod":"POST","MachineName":"DESKTOP-CMP5LCV","EnvironmentName":"Development"}
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Npgsql.PostgresException (0x80004005): 23503: insert or update on table "ShopInventory" violates foreign key constraint "FK_ShopInventory_Drugs_DrugId"

DETAIL: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
   at Npgsql.Internal.NpgsqlConnector.<ReadMessage>g__ReadMessageLong|223_0(NpgsqlConnector connector, Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
  Exception data:
    Severity: ERROR
    SqlState: 23503
    MessageText: insert or update on table "ShopInventory" violates foreign key constraint "FK_ShopInventory_Drugs_DrugId"
    Detail: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
    SchemaName: public
    TableName: ShopInventory
    ConstraintName: FK_ShopInventory_Drugs_DrugId
    File: ri_triggers.c
    Line: 2599
    Routine: ri_ReportViolation
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-10-24 20:36:58.382 +03:00 [INF] [Serilog.AspNetCore.RequestLoggingMiddleware] HTTP POST /api/inventory/shops/SHOP-764C0CB3/stock responded 400 in 892.3263ms {"RequestHost":"localhost:5135","RequestScheme":"http","UserAgent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","RemoteIpAddress":"::1","RequestQuery":"","RequestId":"0HNGJ4FN37JIO:00000002","ConnectionId":"0HNGJ4FN37JIO","MachineName":"DESKTOP-CMP5LCV","EnvironmentName":"Development"}
2025-10-24 20:36:58.385 +03:00 [WRN] [pos_system_api.API.Middleware.RequestResponseLoggingMiddleware] HTTP POST /api/inventory/shops/SHOP-764C0CB3/stock responded 400 in 906ms {"RequestId":"0HNGJ4FN37JIO:00000002","ConnectionId":"0HNGJ4FN37JIO","RemoteIpAddress":"::1","UserAgent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","MachineName":"DESKTOP-CMP5LCV","EnvironmentName":"Development"}
2025-10-24 20:37:04.850 +03:00 [INF] [pos_system_api.API.Middleware.RequestResponseLoggingMiddleware] HTTP POST /api/inventory/shops/SHOP-764C0CB3/stock started {"RequestId":"0HNGJ4FN37JIO:00000003","ConnectionId":"0HNGJ4FN37JIO","RemoteIpAddress":"::1","UserAgent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","MachineName":"DESKTOP-CMP5LCV","EnvironmentName":"Development"}
2025-10-24 20:37:05.197 +03:00 [ERR] [Microsoft.EntityFrameworkCore.Database.Command] Failed executing DbCommand (74ms) [Parameters=[@p0='?', @p1='?' (DbType = Object), @p2='?' (DbType = DateTime), @p3='?', @p4='?', @p5='?' (DbType = Boolean), @p6='?' (DbType = DateTime), @p7='?' (DbType = DateTime), @p8='?' (DbType = Int32), @p9='?', @p10='?', @p11='?' (DbType = Int32), @p12='?', @p13='?' (DbType = Decimal), @p14='?', @p15='?' (DbType = Decimal), @p16='?' (DbType = DateTime), @p17='?' (DbType = Decimal), @p18='?' (DbType = Decimal)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "ShopInventory" ("Id", "Batches", "CreatedAt", "CreatedBy", "DrugId", "IsAvailable", "LastRestockDate", "LastUpdated", "ReorderPoint", "ShopId", "StorageLocation", "TotalStock", "UpdatedBy", "Pricing_CostPrice", "Pricing_Currency", "Pricing_Discount", "Pricing_LastPriceUpdate", "Pricing_SellingPrice", "Pricing_TaxRate")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18); {"EventId":{"Id":20102,"Name":"Microsoft.EntityFrameworkCore.Database.Command.CommandError"},"ActionId":"28dafbba-8ef1-42bb-b730-5ca202ecaffc","ActionName":"pos_system_api.API.Controllers.InventoryController.AddStock (pos_system_api)","RequestId":"0HNGJ4FN37JIO:00000003","RequestPath":"/api/inventory/shops/SHOP-764C0CB3/stock","ConnectionId":"0HNGJ4FN37JIO","RemoteIpAddress":"::1","UserAgent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","RequestQuery":"","RequestMethod":"POST","MachineName":"DESKTOP-CMP5LCV","EnvironmentName":"Development"}
2025-10-24 20:37:05.279 +03:00 [ERR] [Microsoft.EntityFrameworkCore.Update] An exception occurred in the database while saving changes for context type 'pos_system_api.Infrastructure.Data.ApplicationDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Npgsql.PostgresException (0x80004005): 23503: insert or update on table "ShopInventory" violates foreign key constraint "FK_ShopInventory_Drugs_DrugId"

DETAIL: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
   at Npgsql.Internal.NpgsqlConnector.<ReadMessage>g__ReadMessageLong|223_0(NpgsqlConnector connector, Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
  Exception data:
    Severity: ERROR
    SqlState: 23503
    MessageText: insert or update on table "ShopInventory" violates foreign key constraint "FK_ShopInventory_Drugs_DrugId"
    Detail: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
    SchemaName: public
    TableName: ShopInventory
    ConstraintName: FK_ShopInventory_Drugs_DrugId
    File: ri_triggers.c
    Line: 2599
    Routine: ri_ReportViolation
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken) {"EventId":{"Id":10000,"Name":"Microsoft.EntityFrameworkCore.Update.SaveChangesFailed"},"ActionId":"28dafbba-8ef1-42bb-b730-5ca202ecaffc","ActionName":"pos_system_api.API.Controllers.InventoryController.AddStock (pos_system_api)","RequestId":"0HNGJ4FN37JIO:00000003","RequestPath":"/api/inventory/shops/SHOP-764C0CB3/stock","ConnectionId":"0HNGJ4FN37JIO","RemoteIpAddress":"::1","UserAgent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","RequestQuery":"","RequestMethod":"POST","MachineName":"DESKTOP-CMP5LCV","EnvironmentName":"Development"}
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Npgsql.PostgresException (0x80004005): 23503: insert or update on table "ShopInventory" violates foreign key constraint "FK_ShopInventory_Drugs_DrugId"

DETAIL: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
   at Npgsql.Internal.NpgsqlConnector.<ReadMessage>g__ReadMessageLong|223_0(NpgsqlConnector connector, Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
  Exception data:
    Severity: ERROR
    SqlState: 23503
    MessageText: insert or update on table "ShopInventory" violates foreign key constraint "FK_ShopInventory_Drugs_DrugId"
    Detail: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
    SchemaName: public
    TableName: ShopInventory
    ConstraintName: FK_ShopInventory_Drugs_DrugId
    File: ri_triggers.c
    Line: 2599
    Routine: ri_ReportViolation
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-10-24 20:37:05.290 +03:00 [INF] [Serilog.AspNetCore.RequestLoggingMiddleware] HTTP POST /api/inventory/shops/SHOP-764C0CB3/stock responded 400 in 437.3783ms {"RequestHost":"localhost:5135","RequestScheme":"http","UserAgent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","RemoteIpAddress":"::1","RequestQuery":"","RequestId":"0HNGJ4FN37JIO:00000003","ConnectionId":"0HNGJ4FN37JIO","MachineName":"DESKTOP-CMP5LCV","EnvironmentName":"Development"}
2025-10-24 20:37:05.293 +03:00 [WRN] [pos_system_api.API.Middleware.RequestResponseLoggingMiddleware] HTTP POST /api/inventory/shops/SHOP-764C0CB3/stock responded 400 in 443ms {"RequestId":"0HNGJ4FN37JIO:00000003","ConnectionId":"0HNGJ4FN37JIO","RemoteIpAddress":"::1","UserAgent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","MachineName":"DESKTOP-CMP5LCV","EnvironmentName":"Development"}
2025-10-24 20:37:13.151 +03:00 [INF] [pos_system_api.API.Middleware.RequestResponseLoggingMiddleware] HTTP POST /api/inventory/shops/SHOP-764C0CB3/stock started {"RequestId":"0HNGJ4FN37JIO:00000004","ConnectionId":"0HNGJ4FN37JIO","RemoteIpAddress":"::1","UserAgent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","MachineName":"DESKTOP-CMP5LCV","EnvironmentName":"Development"}
2025-10-24 20:37:13.235 +03:00 [INF] [Serilog.AspNetCore.RequestLoggingMiddleware] HTTP POST /api/inventory/shops/SHOP-764C0CB3/stock responded 400 in 81.4409ms {"RequestHost":"localhost:5135","RequestScheme":"http","UserAgent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","RemoteIpAddress":"::1","RequestQuery":"","RequestId":"0HNGJ4FN37JIO:00000004","ConnectionId":"0HNGJ4FN37JIO","MachineName":"DESKTOP-CMP5LCV","EnvironmentName":"Development"}
2025-10-24 20:37:13.238 +03:00 [WRN] [pos_system_api.API.Middleware.RequestResponseLoggingMiddleware] HTTP POST /api/inventory/shops/SHOP-764C0CB3/stock responded 400 in 87ms {"RequestId":"0HNGJ4FN37JIO:00000004","ConnectionId":"0HNGJ4FN37JIO","RemoteIpAddress":"::1","UserAgent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","MachineName":"DESKTOP-CMP5LCV","EnvironmentName":"Development"}
2025-10-24 20:37:23.266 +03:00 [INF] [pos_system_api.API.Middleware.RequestResponseLoggingMiddleware] HTTP POST /api/inventory/shops/SHOP-764C0CB3/stock started {"RequestId":"0HNGJ4FN37JIO:00000005","ConnectionId":"0HNGJ4FN37JIO","RemoteIpAddress":"::1","UserAgent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","MachineName":"DESKTOP-CMP5LCV","EnvironmentName":"Development"}
2025-10-24 20:37:23.419 +03:00 [INF] [Serilog.AspNetCore.RequestLoggingMiddleware] HTTP POST /api/inventory/shops/SHOP-764C0CB3/stock responded 400 in 150.6549ms {"RequestHost":"localhost:5135","RequestScheme":"http","UserAgent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","RemoteIpAddress":"::1","RequestQuery":"","RequestId":"0HNGJ4FN37JIO:00000005","ConnectionId":"0HNGJ4FN37JIO","MachineName":"DESKTOP-CMP5LCV","EnvironmentName":"Development"}
2025-10-24 20:37:23.422 +03:00 [WRN] [pos_system_api.API.Middleware.RequestResponseLoggingMiddleware] HTTP POST /api/inventory/shops/SHOP-764C0CB3/stock responded 400 in 155ms {"RequestId":"0HNGJ4FN37JIO:00000005","ConnectionId":"0HNGJ4FN37JIO","RemoteIpAddress":"::1","UserAgent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","MachineName":"DESKTOP-CMP5LCV","EnvironmentName":"Development"}
2025-10-24 20:37:28.065 +03:00 [INF] [pos_system_api.API.Middleware.RequestResponseLoggingMiddleware] HTTP POST /api/inventory/shops/SHOP-764C0CB3/stock started {"RequestId":"0HNGJ4FN37JIO:00000006","ConnectionId":"0HNGJ4FN37JIO","RemoteIpAddress":"::1","UserAgent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","MachineName":"DESKTOP-CMP5LCV","EnvironmentName":"Development"}
2025-10-24 20:37:28.366 +03:00 [ERR] [Microsoft.EntityFrameworkCore.Database.Command] Failed executing DbCommand (74ms) [Parameters=[@p0='?', @p1='?' (DbType = Object), @p2='?' (DbType = DateTime), @p3='?', @p4='?', @p5='?' (DbType = Boolean), @p6='?' (DbType = DateTime), @p7='?' (DbType = DateTime), @p8='?' (DbType = Int32), @p9='?', @p10='?', @p11='?' (DbType = Int32), @p12='?', @p13='?' (DbType = Decimal), @p14='?', @p15='?' (DbType = Decimal), @p16='?' (DbType = DateTime), @p17='?' (DbType = Decimal), @p18='?' (DbType = Decimal)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "ShopInventory" ("Id", "Batches", "CreatedAt", "CreatedBy", "DrugId", "IsAvailable", "LastRestockDate", "LastUpdated", "ReorderPoint", "ShopId", "StorageLocation", "TotalStock", "UpdatedBy", "Pricing_CostPrice", "Pricing_Currency", "Pricing_Discount", "Pricing_LastPriceUpdate", "Pricing_SellingPrice", "Pricing_TaxRate")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18); {"EventId":{"Id":20102,"Name":"Microsoft.EntityFrameworkCore.Database.Command.CommandError"},"ActionId":"28dafbba-8ef1-42bb-b730-5ca202ecaffc","ActionName":"pos_system_api.API.Controllers.InventoryController.AddStock (pos_system_api)","RequestId":"0HNGJ4FN37JIO:00000006","RequestPath":"/api/inventory/shops/SHOP-764C0CB3/stock","ConnectionId":"0HNGJ4FN37JIO","RemoteIpAddress":"::1","UserAgent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","RequestQuery":"","RequestMethod":"POST","MachineName":"DESKTOP-CMP5LCV","EnvironmentName":"Development"}
2025-10-24 20:37:28.447 +03:00 [ERR] [Microsoft.EntityFrameworkCore.Update] An exception occurred in the database while saving changes for context type 'pos_system_api.Infrastructure.Data.ApplicationDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Npgsql.PostgresException (0x80004005): 23503: insert or update on table "ShopInventory" violates foreign key constraint "FK_ShopInventory_Drugs_DrugId"

DETAIL: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
   at Npgsql.Internal.NpgsqlConnector.<ReadMessage>g__ReadMessageLong|223_0(NpgsqlConnector connector, Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
  Exception data:
    Severity: ERROR
    SqlState: 23503
    MessageText: insert or update on table "ShopInventory" violates foreign key constraint "FK_ShopInventory_Drugs_DrugId"
    Detail: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
    SchemaName: public
    TableName: ShopInventory
    ConstraintName: FK_ShopInventory_Drugs_DrugId
    File: ri_triggers.c
    Line: 2599
    Routine: ri_ReportViolation
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken) {"EventId":{"Id":10000,"Name":"Microsoft.EntityFrameworkCore.Update.SaveChangesFailed"},"ActionId":"28dafbba-8ef1-42bb-b730-5ca202ecaffc","ActionName":"pos_system_api.API.Controllers.InventoryController.AddStock (pos_system_api)","RequestId":"0HNGJ4FN37JIO:00000006","RequestPath":"/api/inventory/shops/SHOP-764C0CB3/stock","ConnectionId":"0HNGJ4FN37JIO","RemoteIpAddress":"::1","UserAgent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","RequestQuery":"","RequestMethod":"POST","MachineName":"DESKTOP-CMP5LCV","EnvironmentName":"Development"}
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Npgsql.PostgresException (0x80004005): 23503: insert or update on table "ShopInventory" violates foreign key constraint "FK_ShopInventory_Drugs_DrugId"

DETAIL: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
   at Npgsql.Internal.NpgsqlConnector.<ReadMessage>g__ReadMessageLong|223_0(NpgsqlConnector connector, Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
  Exception data:
    Severity: ERROR
    SqlState: 23503
    MessageText: insert or update on table "ShopInventory" violates foreign key constraint "FK_ShopInventory_Drugs_DrugId"
    Detail: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
    SchemaName: public
    TableName: ShopInventory
    ConstraintName: FK_ShopInventory_Drugs_DrugId
    File: ri_triggers.c
    Line: 2599
    Routine: ri_ReportViolation
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-10-24 20:37:28.457 +03:00 [INF] [Serilog.AspNetCore.RequestLoggingMiddleware] HTTP POST /api/inventory/shops/SHOP-764C0CB3/stock responded 400 in 389.4973ms {"RequestHost":"localhost:5135","RequestScheme":"http","UserAgent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","RemoteIpAddress":"::1","RequestQuery":"","RequestId":"0HNGJ4FN37JIO:00000006","ConnectionId":"0HNGJ4FN37JIO","MachineName":"DESKTOP-CMP5LCV","EnvironmentName":"Development"}
2025-10-24 20:37:28.460 +03:00 [WRN] [pos_system_api.API.Middleware.RequestResponseLoggingMiddleware] HTTP POST /api/inventory/shops/SHOP-764C0CB3/stock responded 400 in 394ms {"RequestId":"0HNGJ4FN37JIO:00000006","ConnectionId":"0HNGJ4FN37JIO","RemoteIpAddress":"::1","UserAgent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","MachineName":"DESKTOP-CMP5LCV","EnvironmentName":"Development"}
